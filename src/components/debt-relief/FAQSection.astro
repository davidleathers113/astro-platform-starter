---
// src/components/debt-relief/FAQSection.astro
import FAQItem from './FAQItem.astro';

const faqs = [
    {
        question: "How does debt settlement work?",
        answer: "Our program works by negotiating directly with your creditors to reduce the amount you owe. While you make affordable monthly deposits into a dedicated account, our team works to settle each debt for less than the full balance. Once enough funds are accumulated and a settlement is reached, we pay the creditor and the debt is considered resolved."
    },
    {
        question: "What types of debt qualify?",
        answer: "Our program works with unsecured debts such as credit cards, personal loans, medical debt, and some private student loans. Secured debts like mortgages and auto loans, federal student loans, and tax debt typically do not qualify."
    },
    {
        question: "How much does the program cost?",
        answer: "Our fees are performance-based, meaning we only charge when we successfully settle a debt. Fees are calculated as a percentage of the enrolled debt amount or the amount saved, depending on your state. During your free consultation, we'll explain the exact fee structure for your situation."
    },
    {
        question: "Will this affect my credit score?",
        answer: "Yes, debt settlement can negatively impact your credit score initially. When you stop making payments to creditors as part of the program, it will be reported to credit bureaus. However, many clients find that resolving their debt problems provides long-term financial benefits that outweigh the temporary credit impact."
    },
    {
        question: "How long does the program take?",
        answer: "Most clients complete our program within 24-36 months, though timeframes can range from 12-48 months depending on your specific situation, including the amount of debt enrolled and your monthly program payment amount."
    },
    {
        question: "Can creditors sue me during the program?",
        answer: "While creditors have the legal right to pursue collection, including potential lawsuits, our experienced team works to negotiate settlements before such actions occur. If legal action is taken, we work with partners who can provide appropriate guidance."
    }
];
---

<div class="space-y-4 faq-container">
    {faqs.map((faq, index) => (
        <div class="animate-fade-in" style={`animation-delay: ${index * 100}ms`}>
            <FAQItem
                question={faq.question}
                answer={faq.answer}
            />
        </div>
    ))}
</div>

<style>
    /* Ensure SVG icons stay at the correct size and don't get enlarged */
    :global(.faq-container svg) {
        max-width: 20px !important;
        max-height: 20px !important;
        width: 20px !important;
        height: 20px !important;
        flex-shrink: 0 !important;
    }
    
    /* Hide any potential oversized chevrons */
    :global(.faq-container > svg),
    :global(.faq-container svg:not(.faq-icon)) {
        display: none !important;
    }
</style>

<div class="mt-10 text-center animate-fade-in" style="animation-delay: 600ms">
    <a href="tel:8005551234" class="btn btn-lg animate-pulse-once" style="animation-delay: 800ms">Speak With A Specialist Now: (800) 555-1234</a>
</div>

<script>
    // Additional script to ensure all FAQ items are properly initialized
    document.addEventListener('astro:page-load', () => {
        // Get all FAQ items and ensure they're properly set up
        const initializeFAQs = () => {
            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                // Make sure all the required elements exist
                const button = item.querySelector('.faq-question');
                const answer = item.querySelector('.faq-answer');
                const content = item.querySelector('.faq-content');
                const icon = item.querySelector('.faq-icon');
                
                if (button && answer && icon && content) {
                    // Ensure ARIA attributes are correctly set
                    const id = answer.id || `faq-${Math.floor(Math.random() * 10000)}`;
                    
                    // Set the correct ID if it's missing
                    if (!answer.id) {
                        answer.id = id;
                    }
                    
                    button.setAttribute('aria-controls', id);
                    button.setAttribute('aria-expanded', 'false');
                    answer.setAttribute('aria-hidden', 'true');
                }
            });
        };
        
        // Run initialization
        initializeFAQs();
        
        // Add a backup for browsers that might not support the astro:page-load event
        setTimeout(initializeFAQs, 500);
    });
    
    // Fallback for compatibility
    document.addEventListener('DOMContentLoaded', () => {
        if (!document.body.dataset.astroPageLoaded) {
            const event = new Event('astro:page-load');
            document.dispatchEvent(event);
            document.body.dataset.astroPageLoaded = 'true';
        }
    });
</script>

<style>
    .faq-container {
        position: relative;
    }
    
    /* Add staggered animation for better visual experience */
    .faq-container > div {
        opacity: 0;
        transform: translateY(10px);
        animation: fadeSlideUp 0.5s ease-out forwards;
    }
    
    @keyframes fadeSlideUp {
        to { 
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
